<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Anicet Ebou">
<title>3&nbsp; Comparaison de moyennes – Biométrie et expérimentation végétale</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter2.html" rel="next">
<link href="./intro2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter1.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comparaison de moyennes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Biométrie et expérimentation végétale</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Ebedthan/biometrie/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Pourquoi a-t-on besoin de méthodes statistiques ?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rappel des notions de base</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comparaison de moyennes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation entre deux variables continues</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">L\'inférence basée sur la sélection de modèles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#pr%C3%A9ambule" id="toc-préambule" class="nav-link active" data-scroll-target="#pr%C3%A9ambule"><span class="header-section-number">3.1</span> Préambule</a>
  <ul class="collapse">
<li><a href="#nomenclature" id="toc-nomenclature" class="nav-link" data-scroll-target="#nomenclature"><span class="header-section-number">3.1.1</span> Nomenclature</a></li>
  <li><a href="#techniques-de-comparaison-de-moyennes" id="toc-techniques-de-comparaison-de-moyennes" class="nav-link" data-scroll-target="#techniques-de-comparaison-de-moyennes"><span class="header-section-number">3.1.2</span> Techniques de comparaison de moyennes</a></li>
  </ul>
</li>
  <li>
<a href="#comparaison-de-2-moyennes" id="toc-comparaison-de-2-moyennes" class="nav-link" data-scroll-target="#comparaison-de-2-moyennes"><span class="header-section-number">3.2</span> Comparaison de 2 moyennes</a>
  <ul class="collapse">
<li><a href="#donn%C3%A9es-pair%C3%A9es-test-de-t-pair%C3%A9" id="toc-données-pairées-test-de-t-pairé" class="nav-link" data-scroll-target="#donn%C3%A9es-pair%C3%A9es-test-de-t-pair%C3%A9"><span class="header-section-number">3.2.1</span> Données pairées: test de <span class="math inline">\(t\)</span> pairé</a></li>
  <li><a href="#donn%C3%A9es-ind%C3%A9pendantes-test-de-t-ind%C3%A9pendant" id="toc-données-indépendantes-test-de-t-indépendant" class="nav-link" data-scroll-target="#donn%C3%A9es-ind%C3%A9pendantes-test-de-t-ind%C3%A9pendant"><span class="header-section-number">3.2.2</span> Données indépendantes: test de <span class="math inline">\(t\)</span> indépendant</a></li>
  <li><a href="#test-de-t-pair%C3%A9-vs-test-de-t-ind%C3%A9pendant" id="toc-test-de-t-pairé-vs-test-de-t-indépendant" class="nav-link" data-scroll-target="#test-de-t-pair%C3%A9-vs-test-de-t-ind%C3%A9pendant"><span class="header-section-number">3.2.3</span> Test de <span class="math inline">\(t\)</span> pairé <em>vs</em> test de <span class="math inline">\(t\)</span> indépendant</a></li>
  </ul>
</li>
  <li>
<a href="#comparaison-de-plus-de-2-moyennes" id="toc-comparaison-de-plus-de-2-moyennes" class="nav-link" data-scroll-target="#comparaison-de-plus-de-2-moyennes"><span class="header-section-number">3.3</span> Comparaison de plus de 2 moyennes</a>
  <ul class="collapse">
<li><a href="#et-pourquoi-pas-une-s%C3%A9rie-de-tests-de-t" id="toc-et-pourquoi-pas-une-série-de-tests-de-t" class="nav-link" data-scroll-target="#et-pourquoi-pas-une-s%C3%A9rie-de-tests-de-t"><span class="header-section-number">3.3.1</span> Et pourquoi pas une série de tests de <span class="math inline">\(t\)</span> ?</a></li>
  <li><a href="#analyse-de-variance-%C3%A0-un-facteur" id="toc-analyse-de-variance-à-un-facteur" class="nav-link" data-scroll-target="#analyse-de-variance-%C3%A0-un-facteur"><span class="header-section-number">3.3.2</span> Analyse de variance à un facteur</a></li>
  <li><a href="#analyse-de-variance-%C3%A0-deux-facteurs" id="toc-analyse-de-variance-à-deux-facteurs" class="nav-link" data-scroll-target="#analyse-de-variance-%C3%A0-deux-facteurs"><span class="header-section-number">3.3.3</span> Analyse de variance à deux facteurs</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/Ebedthan/biometrie/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comparaison de moyennes</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="préambule" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="préambule">
<span class="header-section-number">3.1</span> Préambule</h2>
<section id="nomenclature" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="nomenclature">
<span class="header-section-number">3.1.1</span> Nomenclature</h3>
<p>Dans ce chapitre, nous supposons que:</p>
<ul>
<li><p>La <strong>réponse</strong> <span class="math inline">\(Y\)</span> est une variable quantitative continue qui suit une distribution normale;</p></li>
<li><p>L’hypothèse de test porte sur l’existence de différence(s) de la moyenne de <span class="math inline">\(Y\)</span> entre plusieurs groupes;</p></li>
<li><p>Les groupes sont des <strong>niveaux</strong> du <strong>facteur/critère</strong> <span class="math inline">\(X\)</span>;</p></li>
<li><p><span class="math inline">\(X\)</span> est une variable discrète, souvent qualitative nominale;</p></li>
<li>
<p><span class="math inline">\(X\)</span> peut être <strong>fixe</strong> ou <strong>aléatoire</strong>:</p>
<ul>
<li><p>fixe: on ne s’intéresse qu’aux niveaux étudiés, choisis spécifiquement (p.&nbsp;ex. mâle <em>vs</em> femelle);</p></li>
<li><p>aléatoire: on s’intéresse à tous les niveaux possibles, parmi lesquels on en a étudié certains choisis aléatoirement (p.&nbsp;ex. Espagne, Finlande et Pologne pour représenter l’UE).</p></li>
</ul>
</li>
</ul></section><section id="techniques-de-comparaison-de-moyennes" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="techniques-de-comparaison-de-moyennes">
<span class="header-section-number">3.1.2</span> Techniques de comparaison de moyennes</h3>
<p>Dans le cas ou le jeu de données contient 2 niveaux pour <span class="math inline">\(X\)</span> (c.à.d. 2 groupes) alors on effectue un test de <span class="math inline">\(t\)</span>. S’il y a plus de 2 niveaux pour <span class="math inline">\(X\)</span> alors une analyse de variance à un critère de classification (ANOVA 1) est choisi. S’il y a plus d’un critère de classification pour <span class="math inline">\(X\)</span> alors on aura un ANOVA2, ANOVA3, …</p>
</section></section><section id="comparaison-de-2-moyennes" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="comparaison-de-2-moyennes">
<span class="header-section-number">3.2</span> Comparaison de 2 moyennes</h2>
<p>On distingue 2 cas pour les expériences où une variable continue <span class="math inline">\(Y\)</span> est mesurée sur les individus appartenant à 2 groupes (A et B):</p>
<ul>
<li><p>Soit une mesure du groupe A est associé avec 1 et 1 seule mesure du groupe B (et inversement): les données sont dites <strong>“pairées”</strong>;</p></li>
<li><p>Soit les mesures du groupe A ne sont pas associées aux mesures du groupe B: les données sont dites <strong>“indépendantes”</strong>.</p></li>
</ul>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lire les valeurs critiques (fractiles) de la loi de t avec R
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pour trouver la valeur critique T dans R, vous pouvez utiliser la fonction qt(), qui utilise la syntaxe suivante :</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">df</span>, lower.tail<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>où :</p>
<ul>
<li><p><strong>p</strong>: le niveau de signification à utiliser;</p></li>
<li><p><strong>df</strong>: Les degrés de liberté;</p></li>
<li><p><strong>lower.tail</strong>: Si TRUE, la probabilité à gauche de <strong>p</strong> dans la distribution <em>t</em> est renvoyée. Si FALSE, la probabilité à droite est renvoyée. La valeur par défaut est TRUE.</p></li>
</ul>
<p><strong>Test unilatéral à gauche</strong></p>
<p>Supposons que nous voulions trouver la valeur critique de <span class="math inline">\(t\)</span> pour un test unilatéral gauche avec un niveau de signification de 0,05 et un degrés de liberté = 18.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span>, df <span class="op">=</span> <span class="fl">18</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.734064</code></pre>
</div>
</div>
<p>La valeur critique <span class="math inline">\(t\)</span> est de -1,734. Ainsi, si la statistique du test est inférieure à cette valeur, les résultats du test sont statistiquement significatifs.</p>
<p><strong>Test unilatéral à droite</strong></p>
<p>Supposons que nous voulions trouver la valeur critique de <span class="math inline">\(t\)</span> pour un test unilatéral à droite avec un niveau de signification de 0,05 et un degrés de liberté = 18.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span>, df <span class="op">=</span> <span class="fl">18</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.734064</code></pre>
</div>
</div>
<p>La valeur critique <span class="math inline">\(t\)</span> est de 1,734. Ainsi, si la statistique du test est supérieur à cette valeur, les résultats du test sont statistiquement significatifs.</p>
<p><strong>Test bilatéral</strong></p>
<p>Supposons que nous voulions trouver la valeur critique de <span class="math inline">\(t\)</span> pour un test bilatéral avec un niveau de signification de 0,05 et un degrés de liberté = 18.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="fl">18</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.100922</code></pre>
</div>
</div>
<p>Chaque fois que vous effectuez un test bilatéral, il y a deux valeurs critiques. Dans le cas présent, les valeurs critiques de T sont 2,1 et -2,1.</p>
<p>Par conséquent, si la statistique du test est inférieure à -2,1 ou supérieure à 2,1, les résultats du test sont statistiquement significatifs.</p>
</div>
</div>
<section id="données-pairées-test-de-t-pairé" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="données-pairées-test-de-t-pairé">
<span class="header-section-number">3.2.1</span> Données pairées: test de <span class="math inline">\(t\)</span> pairé</h3>
<p>Par exemple, on mesure le temps mis par des sprinteurs pour couvrir le 100m lors de 2 jours de course consécutifs, pour vérifier l’existence d’un effet d’adaptation à un environnement non familier. On a alors les hypothèses suivantes:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: il n’y a pas de différence entre les 2 jours;</p></li>
<li><p><span class="math inline">\(H_A\)</span>: il y a une différence entre les 2 jours.</p></li>
</ul>
<p>Pour un test de <span class="math inline">\(t\)</span> pairé on a <span class="math inline">\(t_{obs} = \frac{\bar{Y_D} - \mu_D}{SEM} = \frac{\bar{Y_D} - \mu_D}{\frac{S_D}{\sqrt{n - 1}}} \sim St(n-1)\)</span>.</p>
<p>En partant de l’exemple précédent dont les données onst présentées ici:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 35%">
<col style="width: 35%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th>Numéro</th>
<th>Temps de course (Jour 1)</th>
<th>Temps de course (Jour 2)</th>
<th>Différence&nbsp;</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>13,5</td>
<td>13,6</td>
<td>&nbsp;+0,1</td>
</tr>
<tr class="even">
<td>2</td>
<td>14,6</td>
<td>14,6</td>
<td>0,0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>12,7</td>
<td>12,6</td>
<td>-0,1</td>
</tr>
<tr class="even">
<td>4</td>
<td>15,5</td>
<td>15,7</td>
<td>+0,2</td>
</tr>
<tr class="odd">
<td>5</td>
<td>11,1</td>
<td>11,1</td>
<td>0,0</td>
</tr>
<tr class="even">
<td>6</td>
<td>16,4</td>
<td>16,6</td>
<td>+0,2</td>
</tr>
<tr class="odd">
<td>7</td>
<td>13,2</td>
<td>13,2</td>
<td>0,0</td>
</tr>
<tr class="even">
<td>8</td>
<td>19,3</td>
<td>19,5</td>
<td>+0,2</td>
</tr>
<tr class="odd">
<td>9</td>
<td>16,7</td>
<td>16,8</td>
<td>+0,1</td>
</tr>
<tr class="even">
<td>10</td>
<td>18,4</td>
<td>18,7</td>
<td>+0,3</td>
</tr>
</tbody>
</table>
<p>Pour rappel, le test de <span class="math inline">\(t\)</span> n’est rien d’autre qu’un test d’hypothèse sur une moyenne:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span> :<span class="math inline">\(\mu = \mu_0\)</span> , en d’autre termes la moyenne de la différence est égale à 0;</p></li>
<li><p><span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu \neq \mu_0\)</span>, en d’autres termes, la moyenne de la différence est différente de 0.</p></li>
</ul>
<p>A partir des données ci-dessus présentées on a:</p>
<ul>
<li><p>Dégré de libertés (ddl) = <span class="math inline">\(n-1\)</span> = 10 - 1 = 9;</p></li>
<li><p><span class="math inline">\(\bar{X} = 0,100\)</span>, <span class="math inline">\(s = 0,1247\)</span>, <span class="math inline">\(n = 10\)</span>;</p></li>
<li><p><span class="math inline">\(SEM = \frac{S_D}{\sqrt{n - 1}}\)</span> = 0,0394.</p></li>
</ul>
<p>Pour un dégré de liberté de 9 on a <span class="math inline">\(t_9 = \frac{0,10 - 0}{0,03944} = 2,5355\)</span>.</p>
<p>En utilisant la table ou R (voir ci-dessous) la valeur critique de <span class="math inline">\(t_9\)</span> pour <span class="math inline">\(\alpha = 0,05\)</span> est de <span class="math inline">\(2,262\)</span> (<span class="math inline">\(t_{obs} = 2,5355 &gt; t_{lu} = 2,263\)</span>).</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.05</span><span class="op">/</span><span class="fl">2</span>, df<span class="op">=</span><span class="fl">9</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.262157</code></pre>
</div>
</div>
<p>Par conséquent, la valeur de <span class="math inline">\(t\)</span> se situe en dehors de l’intervalle dans lequel on s’attendrait à ce que <span class="math inline">\(95 \%\)</span> des statistiques <span class="math inline">\(t\)</span> générées par des échantillons de <span class="math inline">\(n = 9\)</span> à partir d’une population où <span class="math inline">\(\mu = 0\)</span>. Il a donc été conclu que la moyenne de la population des différences de temps de course était significativement différente (<span class="math inline">\(P &lt; 0,05\)</span>) d’une moyenne attendue de zéro.</p>
</section><section id="données-indépendantes-test-de-t-indépendant" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="données-indépendantes-test-de-t-indépendant">
<span class="header-section-number">3.2.2</span> Données indépendantes: test de <span class="math inline">\(t\)</span> indépendant</h3>
<p>Un écologiste a échantillonné la longueur de la coquille de 15 palourdes d’eau douce dans chacun de deux lacs afin de déterminer si ces échantillons étaient susceptibles de provenir de populations ayant la même longueur moyenne de coquille.</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Lac A</th>
<th>Lac B</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>25</td>
<td>45</td>
</tr>
<tr class="even">
<td>40</td>
<td>37</td>
</tr>
<tr class="odd">
<td>34</td>
<td>36</td>
</tr>
<tr class="even">
<td>37</td>
<td>38</td>
</tr>
<tr class="odd">
<td>38</td>
<td>49</td>
</tr>
<tr class="even">
<td>35</td>
<td>47</td>
</tr>
<tr class="odd">
<td>29</td>
<td>32</td>
</tr>
<tr class="even">
<td>32</td>
<td>41</td>
</tr>
<tr class="odd">
<td>35</td>
<td>38</td>
</tr>
<tr class="even">
<td>44</td>
<td>45</td>
</tr>
<tr class="odd">
<td>27</td>
<td>33</td>
</tr>
<tr class="even">
<td>33</td>
<td>39</td>
</tr>
<tr class="odd">
<td>37</td>
<td>46</td>
</tr>
<tr class="even">
<td>38</td>
<td>47</td>
</tr>
<tr class="odd">
<td>36</td>
<td>40</td>
</tr>
</tbody>
</table>
<p>Pour cette étude on a les hypothèses suivantes:</p>
<ul>
<li><p><span class="math inline">\(H_0: \mu_A = \mu_B\)</span>: il n’y a pas de différence de taille moyenne entre les 2 lacs;</p></li>
<li><p><span class="math inline">\(H_1: \mu_A \neq \mu_B\)</span>: il y a une différence de taille moyenne entre les 2 lacs.</p></li>
</ul>
<p>Pour tester les hypothèses, il faut tenir compte de la taille des deux populations desquelles dépend le <span class="math inline">\(t_{obs}\)</span> :</p>
<ul>
<li>Si <span class="math inline">\(n_A = n_B\)</span>: <span class="math inline">\(t_{obs} = \frac{(\bar{Y_A} - \bar{Y_B}) - (\mu_A - \mu_B)}{\sqrt{\frac{S^2_A}{n_A} + \frac{S^2_B}{n_B}}} \sim St(n_A + n_B - 2)\)</span>
</li>
<li>Si <span class="math inline">\(n_A \neq n_B\)</span>: <span class="math inline">\(t_{obs} = \frac{(\bar{Y_A} - \bar{Y_B}) - (\mu_A - \mu_B)}{\sqrt{(\frac{(n_A - 1) \times S^2_A + (n_B - 1) \times S^2_B}{n_A + n_B - 2})(\frac{1}{n_A} + \frac{1}{n_B})}} \sim St(n_A + n_B - 2)\)</span>.</li>
</ul>
<p>Notre étude se situant dans le premier cas, on a alors:</p>
<p><span class="math inline">\(t_{obs} = \frac{(34,67 - 40,87) - (0)}{\sqrt{\frac{24,67}{15} + \frac{28,69}{15}}} = -3,287\)</span>.</p>
<p>Avec le dégré de liberté <span class="math inline">\(df = n_A + n_B - 2 = 15 + 15 - 2 = 28\)</span>, on a :</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.05</span><span class="op">/</span><span class="fl">2</span>, df<span class="op">=</span><span class="fl">28</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.048407</code></pre>
</div>
</div>
<p>La valeur critique de <span class="math inline">\(t_{28}\)</span> pour une valeur de 0,05 est de 2,048, de sorte que les deux moyennes de l’échantillon ont une probabilité inférieure à 5 % d’être issues de la même population.</p>
</section><section id="test-de-t-pairé-vs-test-de-t-indépendant" class="level3" data-number="3.2.3"><h3 data-number="3.2.3" class="anchored" data-anchor-id="test-de-t-pairé-vs-test-de-t-indépendant">
<span class="header-section-number">3.2.3</span> Test de <span class="math inline">\(t\)</span> pairé <em>vs</em> test de <span class="math inline">\(t\)</span> indépendant</h3>
<p>Et si on avait analysé l'exemple des sprinteurs comme si les observations des 2 jours étaient indépendantes? A ce moment on obtiendrait <span class="math inline">\(t_{obs} = -0.084\)</span>, <span class="math inline">\(df = 18\)</span>, <span class="math inline">\(t_{lu} = -2,1\)</span>.</p>
<p>La différence entre les 2 jours n'apparaît plus du tout comme significative!!</p>
<p>Pourquoi?</p>
<p>Dans un test de t indépendant, on intègre la différence entre sprinteurs dans la variation due au hasard. De ce fait, la <strong>différence entre moyennes</strong> des 2 jours paraît faible comparée aux différences entre sprinteurs.</p>
</section></section><section id="comparaison-de-plus-de-2-moyennes" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="comparaison-de-plus-de-2-moyennes">
<span class="header-section-number">3.3</span> Comparaison de plus de 2 moyennes</h2>
<p>Dans beaucoup d'expériences biologiques, on veut comparer les moyennes de plus de 2 groupes.</p>
<section id="et-pourquoi-pas-une-série-de-tests-de-t" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="et-pourquoi-pas-une-série-de-tests-de-t">
<span class="header-section-number">3.3.1</span> Et pourquoi pas une série de tests de <span class="math inline">\(t\)</span> ?</h3>
<p>Tout simplement parce que la probabilité d’une erreur de type 1 augmente lorsque vous effectuez plusieurs comparaisons par paire.</p>
<p>Chaque fois que vous effectuez un test statistique où l’hypothèse nulle s’applique, le risque d’une erreur de type 1 est la valeur de <span class="math inline">\(\alpha\)</span>. Si est <span class="math inline">\(\alpha = 0,05\)</span>, la probabilité de <strong>ne pas</strong> commettre d’erreur de type 1 est 1 - <span class="math inline">\(\alpha\)</span> ou 0,95.</p>
<p>Si vous disposez de trois moyennes de traitement et que vous effectuez donc trois comparaisons par paire (1 contre 2, 2 contre 3 et 1 contre 3), la probabilité de <strong>ne pas</strong> commettre d’erreur de type 1 est de <span class="math inline">\((0,95)^3 = 0,86\)</span>. La probabilité <strong>d’au moins une erreur</strong> de type 1 est de 0,14 ou 14 %.</p>
<p>Pour quatre moyennes de traitement, il y a six comparaisons possibles, de sorte que la probabilité d’absence d’erreur de type 1 est de <span class="math inline">\((0,95)^6 = 0,74\)</span>. La probabilité d’au moins une erreur de type 1 est de 0,26 ou 26%.</p>
<p>Pour cinq moyens de traitement, il y a dix comparaisons possibles, la probabilité qu’il n’y ait pas d’erreur de type 1 est donc de <span class="math inline">\((0,95)^10  = 0,60\)</span>. La probabilité d’au moins une erreur de type 1 est de 0,40 ou 40 %.</p>
<p>Ces risques sont inacceptables. Vous avez besoin d’un test qui compare plus de deux moyennes de traitement avec une erreur de type 1 égale à <span class="math inline">\(\alpha\)</span>.</p>
</section><section id="analyse-de-variance-à-un-facteur" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="analyse-de-variance-à-un-facteur">
<span class="header-section-number">3.3.2</span> Analyse de variance à un facteur</h3>
<p>L’analyse de la variance a été développée par le statisticien Sir Ronald A. Fisher à partir de 1918. Il s’agit d’une technique très élégante qui peut être appliquée à de nombreux plans d’expérience très complexes.</p>
<section id="présentation-de-lexemple" class="level4" data-number="3.3.2.1"><h4 data-number="3.3.2.1" class="anchored" data-anchor-id="présentation-de-lexemple">
<span class="header-section-number">3.3.2.1</span> Présentation de l’exemple</h4>
<p>Imaginez que vous souhaitiez évaluer les effets de deux médicaments expérimentaux sur la croissance des tumeurs cérébrales chez l’homme. Un grand nombre de ces tumeurs ne peuvent pas être enlevées car le cerveau serait gravement endommagé. Une tumeur en croissance comprimera et remplacera le tissu neural, causant souvent des dommages mortels, c’est pourquoi il y a un grand intérêt médical pour les médicaments qui affectent la croissance des tumeurs.</p>
<p>On vous a assigné 12 sujets expérimentaux consentants, chacun ayant une tumeur cérébrale de la même taille et du même type. Quatre d’entre eux sont répartis au hasard dans un groupe de contrôle non traité, quatre sont traités avec le médicament «Tumostat» et quatre autres avec le médicament «Inhibin 4». Après deux mois de traitement, leurs tumeurs sont mesurées à nouveau.</p>
<p>Votre hypothèse nulle est la suivante : «Il n’y a pas de différence dans le diamètre moyen des tumeurs entre les populations sur lesquelles ces trois échantillons ont été prélevés». L’hypothèse alternative est la suivante : «Il existe une différence dans le diamètre moyen des tumeurs parmi les populations sur lesquelles ces échantillons ont été prélevés».</p>
<p>Les résultats de cette expérience sont illustrés à la <a href="#fig-pictorial1" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>, le diamètre de la tumeur (en millimètres) augmentant sur l’axe Y et les trois catégories de traitement sur l’axe X.</p>
<div id="fig-pictorial1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial1.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Représentation graphique du diamètre des tumeurs cérébrales humaines chez des volontaires cliniques non traités (contrôle) ou traités avec les médicaments expérimentaux Tumostat ou Inhibin 4. Le diamètre des tumeurs augmente vers le haut de la page. La ligne horizontale épaisse représente la moyenne générale, tandis que les lignes plus courtes et plus claires représentent les moyennes de traitement. Le diamètre de chaque tumeur répliquée est représenté par un carré plein <span class="citation" data-cites="mckillup2011">(<a href="references.html#ref-mckillup2011" role="doc-biblioref">McKillup 2011</a>)</span>.
</figcaption></figure>
</div>
<p>Les moyennes de l’échantillon de chaque groupe de quatre patients ont été calculées à partir des résultats de l’expérience. Les moyennes des échantillons de chaque groupe de quatre sont indiquées, ainsi que la grande moyenne, qui est le diamètre moyen des 12 tumeurs.</p>
<p>Réfléchissez maintenant au diamètre de chaque tumeur. Il existe deux sources possibles de variation qui contribueront à l’éloigner de la moyenne générale <a href="#fig-pictorial2" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>.</p>
<div id="fig-pictorial2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial2.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Les flèches indiquent l’écart de chaque réplicat par rapport à la moyenne de son traitement respectif. Il s’agit uniquement de la variation due à l’erreur <span class="citation" data-cites="mckillup2011">(<a href="references.html#ref-mckillup2011" role="doc-biblioref">McKillup 2011</a>)</span>.
</figcaption></figure>
</div>
<p>Tout d’abord, il y a l’effet du traitement qu’il a subi (Contrôle ou Tumostat ou Inhibine 4). Deuxièmement, il est probable qu’il y ait des variations entre les individus qui ne peuvent pas être contrôlées, telles que de légères différences dans la taille initiale de la tumeur, des différences dans l’état de santé général, le génotype, l’état nutritionnel et les réponses immunitaires de chaque personne, ainsi que d’autres aspects involontaires de l’expérience. Cette variation incontrôlable est appelée « erreur ». Par conséquent, le déplacement de chaque point de l’axe Y par rapport à la moyenne générale sera déterminé par la formule suivante :</p>
<p><span class="math display">\[ \mbox{Diametre de la tumeur} = traitement + erreur\]</span></p>
<p>Dans l’exemple de la <a href="#fig-pictorial1" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>, le Tumostat et l’Inhibine 4 semblent avoir un effet inhibiteur sur la croissance par rapport au contrôle (dans lequel les tumeurs ont grossi), <strong>mais l’effet est-il significatif ou s’agit-il simplement du type de différence qui peut se produire par hasard parmi des échantillons prélevés dans des populations ayant la même moyenne ?</strong></p>
<p>Une ANOVA à facteur unique calcule cette probabilité de manière très simple. Pour comprendre comment l’ANOVA procède, il faut examiner les raisons pour lesquelles les valeurs de chaque tumeur et les moyennes de traitement sont là où elles sont: * Tout d’abord, le diamètre de chaque tumeur s’écarte de la moyenne de son traitement uniquement en raison de l’erreur. C’est ce qu’on appelle <strong>l’erreur</strong> ou la <strong>variation à l’intérieur du groupe</strong>;<br>
* Deuxièmement, la moyenne de chaque traitement sera décalée de la grande moyenne par tout effet de ce traitement plus l’erreur. Ici, puisqu’il s’agit de moyennes de traitement, la distance entre la moyenne d’un traitement particulier et la grande moyenne est l’effet moyen de toutes les répétitions de ce traitement. Pour obtenir l’effet total, il faut considérer que ce déplacement se produit pour chacune des répétitions. C’est ce qu’on appelle <strong>la variation entre les groupes</strong>;<br>
* Troisièmement, le diamètre de chaque tumeur sera décalé de la moyenne générale par <strong>les deux sources</strong> de variation - la variation au sein du groupe (<a href="#fig-pictorial2" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>) et la variation entre les groupes (<a href="#fig-pictorial3" class="quarto-xref">Figure&nbsp;<span>3.3</span></a>) décrites ci-dessus. C’est ce qu’on appelle <strong>la variation totale</strong> de l’expérience.</p>
<div id="fig-pictorial3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial3.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Les flèches indiquent le déplacement de la moyenne de chaque traitement par rapport à la moyenne générale et représentent l’effet moyen du traitement plus l’erreur pour les répétitions de ce traitement.
</figcaption></figure>
</div>
<p>La figure <a href="#fig-pictorial4" class="quarto-xref">Figure&nbsp;<span>3.4</span></a> montre la distance déplacée pour les quatre tumeurs de chaque traitement.</p>
<div id="fig-pictorial4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial4.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Les flèches indiquent l’écart de chaque réplicat par rapport à la moyenne générale. La longueur de chaque flèche représente la variation totale affectant chaque réplicat.
</figcaption></figure>
</div>
<p>Chacune des figures <a href="#fig-pictorial1" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> - <a href="#fig-pictorial4" class="quarto-xref">Figure&nbsp;<span>3.4</span></a> montre la dispersion des points autour des moyennes. Il est donc possible de calculer une variance distincte pour chaque figure:</p>
<ul>
<li>La variance intra-groupe, qui n’est due qu’à l’erreur (<a href="#fig-pictorial2" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>), peut être calculée à partir de la dispersion des points autour de la moyenne de chaque traitement.<br>
</li>
<li>La variance entre les groupes, qui est due au traitement et à l’erreur (<a href="#fig-pictorial3" class="quarto-xref">Figure&nbsp;<span>3.3</span></a>), peut être calculée à partir de la dispersion des moyennes de traitement autour de la grande moyenne. La distance entre la moyenne de chaque traitement et la moyenne générale représente l’effet moyen pour le nombre de répétitions dans ce traitement.<br>
</li>
<li>La variance totale (<a href="#fig-pictorial4" class="quarto-xref">Figure&nbsp;<span>3.4</span></a>) est l’effet combiné de la variance intra-groupe et de la variance inter-groupe. Elle peut être calculée à partir de la dispersion de tous les points autour de la grande moyenne.</li>
</ul>
<p>Ces estimations permettent d’évaluer très facilement si les moyennes des trois traitements proviennent de populations ayant la même moyenne <span class="math inline">\(\mu\)</span>. Premièrement, si aucun traitement n’a d’effet, la variance entre les groupes (due au traitement plus à l’erreur) sera un petit nombre, car toutes les moyennes du traitement ne seront éloignées de la grande moyenne que par l’effet de l’erreur (<a href="#fig-pictorial5" class="quarto-xref">Figure&nbsp;<span>3.5</span></a> (a)). Deuxièmement, si l’effet du traitement est relativement important, certaines ou toutes les moyennes du traitement seront très différentes les unes des autres et plus éloignées de la grande moyenne. Par conséquent, la variance entre les groupes (due au traitement et à l’erreur) sera importante par rapport à la variance à l’intérieur du groupe (due à l’erreur uniquement) (<a href="#fig-pictorial5" class="quarto-xref">Figure&nbsp;<span>3.5</span></a> (b)). Au fur et à mesure que les différences entre les traitements s’accroissent, la variance entre les groupes s’accroît également.</p>
<div id="fig-pictorial5" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial5.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: (a) Aucun effet du traitement. Les moyennes des trois traitements ne s’écartent de la moyenne générale qu’en raison de l’erreur, de sorte que la variance entre les groupes sera relativement faible. (b) Un effet du traitement. Il existe des différences relativement importantes entre les moyennes du traitement, de sorte qu’elles sont plus éloignées de la moyenne générale, ce qui rend la variance entre les groupes relativement importante.
</figcaption></figure>
</div>
<p>Par conséquent, pour obtenir une statistique montrant <strong>l’effet relatif des traitements par rapport à l’erreur, il suffit de calculer la variance entre les groupes (due aux traitements plus l’erreur) et de la diviser par la variance à l’intérieur du groupe (due à l’erreur)</strong>:</p>
<p><span class="math display">\[\frac{\mbox{Variance inter-groupe (traitement + erreur)}}{\mbox{Variance intra-groupe (erreur)}}\]</span></p>
<p>S’il n’y a pas d’effet de traitement, le numérateur et le dénominateur de l’équation ne feront qu’estimer l’erreur, de sorte que la valeur de cette statistique sera d’environ 1,0 (<a href="#fig-pictorial5" class="quarto-xref">Figure&nbsp;<span>3.5</span></a> (a)). Cependant, à mesure que l’effet du traitement augmente (<a href="#fig-pictorial5" class="quarto-xref">Figure&nbsp;<span>3.5</span></a> (b)), le numérateur de l’équation devient de plus en plus grand, de sorte que la valeur de la statistique augmente également. Au fur et à mesure qu’elle augmente, la probabilité que les traitements aient été effectués sur des populations ayant la même moyenne diminue et finit par être inférieure à 0,05.</p>
<p>La statistique obtenue en divisant une variance par une autre s’appelle la <strong>statistique <em>F</em></strong> ou le <strong>ratio <em>F</em></strong>. Une fois le F calculé, sa signification peut être évaluée en recherchant la distribution attendue de F sous l’hypothèse nulle d’absence de différence entre les moyennes de traitements. Lorsque les groupes de traitements sont issus de populations ayant la même moyenne (c’est-à-dire qu’aucun des traitements n’a d’effet), la valeur de la statistique sera, seulement supérieure à une valeur particulière dans 5 % des cas et sera considérée comme statistiquement significative.</p>
</section><section id="calcul-du-f" class="level4" data-number="3.3.2.2"><h4 data-number="3.3.2.2" class="anchored" data-anchor-id="calcul-du-f">
<span class="header-section-number">3.3.2.2</span> Calcul du <em>F</em>
</h4>
<p>Pour réaliser une ANOVA à un seul facteur, il suffit de calculer la variance entre les groupes (inter groupe) (traitement) et de la diviser par la variance à l’intérieur du groupe (intra groupe) (erreur) pour obtenir le ratio <em>F</em>.</p>
<p>Les données de l’exemple ci-dessus sont:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Contrôle</th>
<th>Tumostat</th>
<th>Inhibin 4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>4</td>
<td>1</td>
</tr>
<tr class="even">
<td>8</td>
<td>5</td>
<td>2</td>
</tr>
<tr class="odd">
<td>10</td>
<td>7</td>
<td>4</td>
</tr>
<tr class="even">
<td>11</td>
<td>8</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>On peut les représenter graphiquement à l’aide de cette illustration <a href="#fig-pictorial6" class="quarto-xref">Figure&nbsp;<span>3.6</span></a>:</p>
<div id="fig-pictorial6" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial6.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Représentation graphique du diamètre des tumeurs cérébrales humaines chez des volontaires cliniques non traités (contrôle) ou traités avec les médicaments expérimentaux Tumostat ou Inhibin 4.
</figcaption></figure>
</div>
<section id="calcul-de-la-variation-intra-groupe-erreur" class="level5" data-number="3.3.2.2.1"><h5 data-number="3.3.2.2.1" class="anchored" data-anchor-id="calcul-de-la-variation-intra-groupe-erreur">
<span class="header-section-number">3.3.2.2.1</span> Calcul de la variation intra-groupe (erreur)</h5>
<p>Commençons par calculer la variance à l’intérieur du groupe (intra-groupe) (erreur) <a href="#fig-pictorial7" class="quarto-xref">Figure&nbsp;<span>3.7</span></a>:</p>
<div id="fig-pictorial7" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial7.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Calcul de la variance intra-groupe.
</figcaption></figure>
</div>
<p>La <strong>somme des carrés intra-groupe</strong> (erreur) est <span class="math display">\[ SCR = \sum^n_{i=1}(x_i - \bar{x})^2\]</span>. On a donc:</p>
<p><span class="math inline">\(SCR = ((7 - 9)^2 + (8 - 9)^2 + (10 - 9)^2 + (11 - 9)^2) + ((4 - 6)^2 + (5 - 6)^2 + (7 - 6)^2 + (8 - 6)^2) + ((1 - 3)^2 + (2 - 3)^2 + (4 - 3)^2 + (5 - 3)^2)\)</span></p>
<p><span class="math display">\[ SCR = (4 + 1 + 1 + 4) + (4 + 1 + 1 + 4) + (4 + 1 + 1 + 4) = 30 \]</span></p>
<p>D’où on obtient la <strong>variance intra-groupe</strong> (erreur) est <span class="math display">\[ \frac{SCR}{n} = 30 \div 9 = 3,33 \]</span>.</p>
</section><section id="calcul-de-la-variance-inter-groupe-traitement" class="level5" data-number="3.3.2.2.2"><h5 data-number="3.3.2.2.2" class="anchored" data-anchor-id="calcul-de-la-variance-inter-groupe-traitement">
<span class="header-section-number">3.3.2.2.2</span> Calcul de la variance inter-groupe (traitement)</h5>
<p>Ensuite on peut calculer la variance entre groupe (inter-groupe) (traitement). Cela se fait en deux étapes. Tout d’abord, le déplacement de la moyenne de chaque traitement par rapport à la moyenne générale est élevé au carré. Cette valeur doit être multipliée par la taille de l’échantillon pour chaque traitement afin d’obtenir l’effet total pour les répétitions de ce traitement, car le déplacement est la moyenne pour le traitement. Ces trois valeurs sont ensuite additionnées pour obtenir la somme des carrés. Ensuite, la somme des carrés sont divisés par le nombre de degrés de liberté pour obtenir la valeur carrée moyenne, qui est la variance entre les groupes (traitement) <a href="#fig-pictorial8" class="quarto-xref">Figure&nbsp;<span>3.8</span></a>.</p>
<div id="fig-pictorial8" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial8.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Calcul de la variance inter-groupe.
</figcaption></figure>
</div>
<p>On a donc la <strong>somme des carrés inter-groupe (traitement)</strong> <span class="math inline">\(= (9 - 6)^2 \times 4 + (6 - 6)^2 \times 4 + (3 - 6)^2 \times 4 = 72\)</span>.</p>
<p>La <strong>variance intra-groupe</strong> (traitement) est donc <span class="math inline">\(72 \div 2 = 36\)</span>.</p>
</section><section id="calcul-de-la-variance-totale" class="level5" data-number="3.3.2.2.3"><h5 data-number="3.3.2.2.3" class="anchored" data-anchor-id="calcul-de-la-variance-totale">
<span class="header-section-number">3.3.2.2.3</span> Calcul de la variance totale</h5>
<p>Tout d’abord, il faut calculer la somme des carrés pour la variation totale en prenant le déplacement de chaque point par rapport à la moyenne générale, en l’élevant au carré et en l’additionnant pour toutes les répétitions. On obtient ainsi la somme totale des carrés. En divisant la somme totale des carrés par le nombre total de degrés de liberté (il y a <span class="math inline">\(n -1\)</span> degrés de liberté, et dans ce cas <span class="math inline">\(n = 12\)</span>), on obtient le carré moyen <a href="#fig-pictorial9" class="quarto-xref">Figure&nbsp;<span>3.9</span></a>.</p>
<div id="fig-pictorial9" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pictorial9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/pictorial9.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pictorial9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Calcul de la somme totale des carrés et de la variation totale.
</figcaption></figure>
</div>
<p>On a donc la somme des carrés totaux :<br><span class="math display">\[(25 + 16 + 4 + 1) + (4 + 1 + 1 + 4) + (25 + 16 + 4 + 1) = 102\]</span></p>
<p>Et la variance totale est: <span class="math inline">\(102 \div 11 = 9,273\)</span>.</p>
</section><section id="calcul-du-f-1" class="level5" data-number="3.3.2.2.4"><h5 data-number="3.3.2.2.4" class="anchored" data-anchor-id="calcul-du-f-1">
<span class="header-section-number">3.3.2.2.4</span> Calcul du <em>F</em>
</h5>
<p>Enfin, pour obtenir le rapport F, qui compare l’effet du traitement à l’effet de l’erreur, il suffit de diviser la variance entre les groupes (traitement) par la variance à l’intérieur des groupes (erreur). Étant donné que la variance du traitement est de 36 (<a href="#fig-pictorial8" class="quarto-xref">Figure&nbsp;<span>3.8</span></a>) et que la variance de l’erreur est de 3,33 (<a href="#fig-pictorial7" class="quarto-xref">Figure&nbsp;<span>3.7</span></a>), le rapport F de la variance du traitement / variance de l’erreur est de <span class="math inline">\(36 \div 3,33 = 10,8\)</span>.</p>
<p>La table suivante donne les résultats de cette analyse dans un format similaire à celui fourni par la plupart des logiciels statistiques.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 24%">
<col style="width: 6%">
<col style="width: 18%">
<col style="width: 4%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th>Source de variation</th>
<th>Somme des carrés</th>
<th>ddl</th>
<th>Somme des carrés moyens</th>
<th>F</th>
<th>Probabilité</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Inter-groupe (traitement)</td>
<td>72</td>
<td>2</td>
<td>36,0</td>
<td>10,8</td>
<td>0,004</td>
</tr>
<tr class="even">
<td>Intra-groupe (erreur)</td>
<td>30</td>
<td>9</td>
<td>3,3</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Totale</td>
<td>102</td>
<td>11</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Vous vous demanderez peut-être pourquoi la somme totale des carrés et la variance totale de l’expérience ont été calculées, puisqu’elles ne sont pas nécessaires pour le rapport <em>F</em> donné ci-dessus. Le calcul a été inclus pour illustrer l’additivité des sommes des carrés et des degrés de liberté. Le tableau 9.2 montre que la somme totale des carrés (102) est la somme des sommes des carrés du traitement (72) et de l’erreur (30). Notez également que le total des degrés de liberté (11) est la somme du traitement (2) et de l’erreur (9) degrés de liberté. Cette additivité des sommes des carrés et des degrés de liberté sera utilisée lors de l’examen de modèles ANOVA plus complexes.</p>
<p>Il ne vous reste plus qu’à trouver la valeur critique du rapport <em>F</em>. Cette procédure était autrefois fastidieuse car il y avait deux valeurs de degrés de liberté à prendre en compte - celle associée au carré moyen du traitement et celle associée au carré moyen de l’erreur - et vous deviez rechercher la valeur critique dans un grand nombre de tableaux. Ici, cependant, vous pouvez utiliser un programme de statistiques pour effectuer cette analyse, générer le rapport <em>F</em> et obtenir la probabilité.</p>
<p>La valeur de probabilité (p-value) présentée dans ce tableau peut être obtenue dans R par la commande:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="fl">10.8</span>, <span class="fl">2</span>, <span class="fl">9</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004058307</code></pre>
</div>
</div>
<p>Cette analyse peut être effectuée de la même manière dans R avec les commandes suivantes:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement des données</span></span>
<span><span class="va">cancer.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/cancer.csv"</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lancement de l'analyse de variance</span></span>
<span><span class="va">res.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">diameter</span> <span class="op">~</span> <span class="va">drugs</span>, data <span class="op">=</span> <span class="va">cancer.data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Affichage du résultat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res.aov</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
drugs        2     72   36.00    10.8 0.00406 **
Residuals    9     30    3.33                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>On obtient alors un tableau similaire à celui présenté plus haut.</p>
<p>En conclusion <span class="math inline">\(p = 0,04 &lt; 0,05\)</span>, donc on peut rejeter <span class="math inline">\(H_0\)</span>, ce qui nous permet de parier avec une probabilité <span class="math inline">\(p\)</span> de nous tromper qu’il existe au moins un groupe qui a une moyenne réelle <span class="math inline">\(\mu\)</span> différente des autres.</p>
</section></section><section id="anova-à-un-facteur-vs-test-de-t-indépendant" class="level4" data-number="3.3.2.3"><h4 data-number="3.3.2.3" class="anchored" data-anchor-id="anova-à-un-facteur-vs-test-de-t-indépendant">
<span class="header-section-number">3.3.2.3</span> ANOVA à un facteur <em>vs</em> test de <em>t</em> indépendant</h4>
<p>S’il n’y a que 2 groupes dont les observations sont indépendantes, test de <em>t</em> indépendant et ANOVA 1 sont équivalents.</p>
<p><span class="math inline">\(F_{obs} = (t_{obs})^2\)</span>, les <span class="math inline">\(p\)</span> sont identiques.</p>
<p>Les deux tests ont la même <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \mu_2\)</span> mais seul le test de <em>t</em> permet une <span class="math inline">\(H_A\)</span> du type &lt; ou &gt;. Si on veut une telle <span class="math inline">\(H_A\)</span> unidirectionnelle ou tester une différence entre moyennes autre que 0 alors seul le test de <em>t</em> convient.</p>
</section><section id="comment-savoir-quels-groupes-ont-des-moyennes-différentes" class="level4" data-number="3.3.2.4"><h4 data-number="3.3.2.4" class="anchored" data-anchor-id="comment-savoir-quels-groupes-ont-des-moyennes-différentes">
<span class="header-section-number">3.3.2.4</span> Comment savoir quels groupes ont des moyennes différentes?</h4>
<p>Lorsque vous utilisez une ANOVA à facteur unique pour examiner les résultats d’une expérience comportant trois traitements ou plus, un résultat significatif indique seulement qu’un ou plusieurs traitements semblent provenir de populations ayant des moyennes différentes. <strong>Il n’identifie pas les moyennes des traitements particuliers qui semblent provenir de la même population ou de populations différentes.</strong></p>
<p>Par exemple, une différence significative entre les moyennes des trois traitements A, B et C peut se produire de plusieurs façons. La moyenne A peut être supérieure (ou inférieure) à B et C ; la moyenne B peut être supérieure (ou inférieure) à A et C ; la moyenne C peut être supérieure (ou inférieure) à A et B ; et, enfin, les moyennes A, B et C peuvent toutes être différentes l’une de l’autre.</p>
<p>Deux stratégies sont alors possibles:</p>
<ul>
<li>Les tests de comparaison multiples <em>a posteriori</em> ou encore tests posthoc;<br>
</li>
<li>Les comparaison <em>a priori</em> ou encore contrastes <em>a priori</em>.</li>
</ul>
<section id="tests-de-comparaison-multiples-a-posteriori" class="level5" data-number="3.3.2.4.1"><h5 data-number="3.3.2.4.1" class="anchored" data-anchor-id="tests-de-comparaison-multiples-a-posteriori">
<span class="header-section-number">3.3.2.4.1</span> Tests de comparaison multiples <em>a posteriori</em>
</h5>
<p>Les tests de comparaisons multiples sont utilisés pour comparer un ensemble de moyennes et les affecter à des groupes qui semblent provenir de la même population. Ces tests sont généralement effectués après qu’une ANOVA I a montré une différence significative entre les traitements. Ils sont appelés tests a posteriori ou post hoc, qui signifient tous deux «après l’événement», où l’«événement» est un résultat significatif de l’ANOVA.</p>
<p>De nombreux tests de comparaison multiple ont été mis au point, mais tous fonctionnent essentiellement de la même manière.</p>
<p>La statistique <em>t</em> est calculée en divisant la différence entre deux moyennes par l’erreur standard de cette différence. La statistique de Tukey, <span class="math inline">\(q\)</span>, est calculée en divisant la différence entre deux moyennes par l’erreur standard de la moyenne. La plus petite moyenne est toujours retranchée de la plus grande, ce qui donne un nombre positif : <span class="math display">\[ q = \frac{\bar{X_A} - \bar{X_B}}{SEM} \]</span></p>
<p>Cette procédure est d’abord utilisée pour comparer la plus grande moyenne à la plus petite. Si la différence est significative, le test se poursuit en comparant la plus grande à la plus petite suivante et ainsi de suite. Si une différence non significative est trouvée, toutes les moyennes comprises dans l’intervalle entre cette paire sont affectées à la même population. La procédure est ensuite répétée, en commençant par la deuxième plus grande et la plus petite moyenne ; elle est répétée à nouveau en commençant par la troisième plus grande et la plus petite moyenne, et ainsi de suite. Finalement, les moyennes seront affectées à un ou plusieurs groupes, chacun contenant celles qui semblent provenir de la même population.</p>
<p>Pour la statistique de Tukey, vous avez besoin de la SEM (Standard Error Mean, Erreur standard moyenne) et la meilleure façon de l’obtenir est d’utiliser l’erreur quadratique moyenne de l’ANOVA, car il s’agit d’une estimation de la variance de la population, <span class="math inline">\(\sigma^2\)</span>, calculée à partir du déplacement de tous les réplicats de l’expérience par rapport à leurs moyennes de traitement respectives. Par conséquent, étant donné que l’erreur standard d’une moyenne est : <span class="math display">\[ SEM = \frac{\sigma}{\sqrt{n}} = \sqrt{\frac{\sigma^2}{n}}\]</span>.</p>
<p>L’erreur standard de la moyenne estimée à partir d’une ANOVA est: <span class="math display">\[ SEM = \sqrt{\frac{MS error}{n}} \]</span>.</p>
<p>La valeur calculée de <em>q</em> sera nulle lorsqu’il n’y a pas de différence entre les moyennes des deux échantillons et augmentera au fur et à mesure que la différence entre les moyennes s’accroît. Si <em>q</em> dépasse la valeur critique, l’hypothèse selon laquelle les moyennes proviennent de la même population est rejetée. La valeur critique de <em>q</em> dépend de la valeur de <span class="math inline">\(\alpha\)</span>, du nombre de degrés de liberté pour l’erreur de MS et du nombre de moyennes testées.</p>
<p><strong>Test de Tukey avec R</strong></p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement des données</span></span>
<span><span class="va">cancer.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/cancer.csv"</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lancement de l'analyse de variance</span></span>
<span><span class="va">res.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">diameter</span> <span class="op">~</span> <span class="va">drugs</span>, data <span class="op">=</span> <span class="va">cancer.data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Affichage du résultat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res.aov</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
drugs        2     72   36.00    10.8 0.00406 **
Residuals    9     30    3.33                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Test de Tukey</span></span>
<span><span class="va">tukey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">res.aov</span>, <span class="st">'drugs'</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Resumé du test de Tukey</span></span>
<span><span class="va">tukey</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = diameter ~ drugs, data = cancer.data)

$drugs
                   diff        lwr        upr     p adj
inhibin 4-control    -6 -9.6044637 -2.3955363 0.0030996
tumostat-control     -3 -6.6044637  0.6044637 0.1032324
tumostat-inhibin 4    3 -0.6044637  6.6044637 0.1032324</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Graphique du test de Tukey</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tukey</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="chapter1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Autres tests</strong></p>
<p>Il existe de nombreux autres tests de comparaison multiple. Il s’agit notamment des tests LSD, Bonferroni, Scheffé et Student-Newman-Keuls. Les plus couramment utilisés sont les tests de Tukey et de Student-Newman-Keuls (Zar, 1999). La plupart des progiciels statistiques offrent un large choix de ces tests, dont les mérites relatifs sont décrits dans des textes plus avancés.</p>
</section><section id="tests-a-priori" class="level5" data-number="3.3.2.4.2"><h5 data-number="3.3.2.4.2" class="anchored" data-anchor-id="tests-a-priori">
<span class="header-section-number">3.3.2.4.2</span> Tests <em>a priori</em>
</h5>
<p>Nous avons précédemment discuté sur le danger d’une probabilité accrue d’erreur de type 1 lorsque l’on effectue de nombreuses comparaisons par paire entre trois moyennes ou plus. Ici, cependant, la méthode <em>a posteriori</em> permettant d’identifier les moyennes de traitement qui semblent provenir de la même population utilise de nombreuses comparaisons par paires. Vous pouvez donc être amenés à penser que cette procédure présente également un risque accru d’erreur de type 1. Cependant, celà n’est pas le cas. Tout d’abord, les comparaisons <em>a-posteriori</em> non planifiées ne sont généralement effectuées entre tous les groupes que si l’ANOVA a détecté une différence significative entre les moyennes des traitements. Deuxièmement, les tests <em>a posteriori</em> sont spécifiquement conçus pour prendre en compte le nombre de moyennes comparées et présentent un risque d’erreur de type 1 beaucoup plus faible que le même nombre de tests t. Malheureusement, cela rend les tests de comparaison multiple relativement peu puissants.</p>
<p>Par exemple, il arrive parfois qu’une ANOVA détecte une différence significative entre les traitements, mais que les tests a posteriori ultérieurs ne parviennent pas à détecter une différence significative entre les moyennes. Au lieu d’effectuer un grand nombre de comparaisons a posteriori non planifiées et sans discernement, une meilleure approche peut consister à effectuer un petit nombre de comparaisons planifiées (a-priori, c’est-à-dire « avant l’événement »). Par exemple, votre hypothèse pourrait être que chacun des deux médicaments expérimentaux utilisés dans l’exemple ci-dessus <strong>réduira</strong> la croissance des tumeurs cérébrales par rapport au contrôle. Une ANOVA permettra de tester les différences entre les traitements avec un coefficient de 0,05 et donnera également une bonne estimation de la variance de l’échantillon à partir de l’erreur systémique, puisque celle-ci a été calculée à partir de tous les individus utilisés dans l’expérience. Toutefois, au lieu d’effectuer un grand nombre de comparaisons imprévues, vous pourriez effectuer deux tests <em>t</em> (unilatéraux) comparant la croissance moyenne des tumeurs dans chaque traitement médicamenteux et dans le contrôle.</p>
<p>Si vous ne faites qu’une seule comparaison planifiée, la probabilité d’une erreur de type 1 est de 0,05, ce qui est acceptable. Si vous effectuez plusieurs comparaisons <em>a priori</em> <strong>qui ont réellement été planifiées pour des raisons particulières avant l’expérience</strong> (par exemple, pour tester les hypothèses «Inhibin 4 réduit la croissance de la tumeur par rapport au contrôle non traité» et «Tumostat réduit la croissance de la tumeur par rapport au contrôle non traité»), chacune est une hypothèse distincte et différente, de sorte que le risque d’une erreur de type 1 est encore acceptable à 0,05. Ce n’est que lorsque vous effectuez des comparaisons sans discernement que le risque d’erreur de type 1 augmente et que vous devez envisager d’utiliser l’un des tests a posteriori décrits précédemment, qui maintient un taux d’erreur de 0,05.</p>
<section id="test-de-t-pour-deux-moyennes" class="level6" data-number="3.3.2.4.2.1"><h6 data-number="3.3.2.4.2.1" class="anchored" data-anchor-id="test-de-t-pour-deux-moyennes">
<span class="header-section-number">3.3.2.4.2.1</span> Test de <em>t</em> pour deux moyennes</h6>
<p>Le test <em>a priori</em> le plus simple est une comparaison entre deux moyennes. Dans notre exemple, supposons qu’avant de réaliser l’expérience, nous ayons émis l’hypothèse <em>a priori</em> qu’il existe une différence dans le diamètre moyen du test entre les traitement de Inhibin 4 et de contrôle. Cela conduit à comparer les moyennes <span class="math inline">\(\bar{X_A} = 9\)</span> et <span class="math inline">\(\bar{X_B} = 3\)</span>. Pour effectuer une comparaison planifiée après une ANOVA à un facteur, vous utilisez la formule pour un test <em>t</em>, sauf que vous utilisez l’erreur quadratique moyenne (MS error) comme meilleure estimation de <span class="math inline">\(s^2\)</span>: <span class="math display">\[ t_{n_A + n_B - 2} = \frac{\bar{X_A} - \bar{X_B}}{\sqrt{\frac{2 \times MS error}{n}}} \]</span>.</p>
<p>Le dégré de liberté de cette statistique est le dégré de liberté de l’erreur quadratique moyenne. Dans notre exemple cela donne: <span class="math display">\[ t_6 = \frac{9 - 3}{\sqrt{\frac{2 \times 3,33}{4}}} = 4,649\]</span>.</p>
<p>Etant donné que la valeur critique unilatérale de 5 % pour t est de 2,446 (p = 0,001), on peut conclure que ces deux moyennes semblent également provenir de populations différentes.</p>
</section><section id="contrates-pour-deux-moyennes." class="level6" data-number="3.3.2.4.2.2"><h6 data-number="3.3.2.4.2.2" class="anchored" data-anchor-id="contrates-pour-deux-moyennes.">
<span class="header-section-number">3.3.2.4.2.2</span> Contrates pour deux moyennes.</h6>
<p>Une autre façon d’envisager la comparaison que nous venons de faire entre les moyennes des Inhibin 4 et de contrôle est de considérer le numérateur de notre test <em>t</em> comme une «combinaison linéaire» de moyennes. Une combinaison linéaire est simplement une somme de valeurs pondérées. Pour cette comparaison, nous attribuons un poids de 1 au traitement Inhibin 4 et un poids de -1 au contrôle. Toutes les autres moyennes ont un poids nul. Nous utilisons la notation psi (<span class="math inline">\(\psi\)</span>) qui indique la somme pondérée des moyennes, avec des pondérations <span class="math inline">\(\alpha_i\)</span> pour chaque moyenne, <span class="math inline">\(\bar{X_i}\)</span>. Pour notre exemple précédent on a :</p>
<p><span class="math display">\[ \psi = (1) \times 9 + (-1) \times 3 = 6 \]</span>.</p>
<p>Le test d’hypothèse pour les contrastes peut être effectué sous la forme d’un test <em>t</em> ou d’un test <em>F</em> puisque lorsque <span class="math inline">\(ddl = 1, \mbox{on a} F = t^2\)</span>. Nous utiliserons le test <em>F</em>. Le numérateur du test <em>F</em> est calculé avec les sommes des erreurs quadratiques suivantes : <span class="math display">\[ SC_{contraste} = \frac{\psi^2}{\sum (\alpha_i^2/n_i)} \]</span>. Ce qui équivaut, lorsque la taille des échantillons est la même à: <span class="math display">\[ SC_{contraste} = \frac{\psi^2}{(\sum \alpha_i^2)/n} \]</span>.</p>
<p>On a donc: <span class="math display">\[ SC_{contraste} =  \frac{6^2}{(1^2 + (-1)^2)/4} = 72\]</span>.</p>
<p>L’erreur quadratique moyenne est toujours la somme des erreurs quadratiques divisée par les degrés de liberté. Le dégré de liberté pour les contrastes <em>a priori</em> est toujours égal à 1, de sorte que le numérateur du test <em>F</em> est le suivant: <span class="math display">\[ MS_{contraste} = \frac{SC_{contraste}}{1} = SC_{contraste} \]</span>.</p>
<p>Le dénominateur du test <em>F</em> pour les contrastes <em>a priori</em> est le même que celui du test <em>F</em>. Notre valeur <em>F</em> est donc la suivante: <span class="math display">\[ F(1, ddl_{erreur} = \frac{MS_{contraste}}{MS_{erreur}}) \]</span>.</p>
<p>Ce qui correspond dans notre exemple à: <span class="math display">\[ F(1, 9) = \frac{72}{3,33} = 21,62\]</span>.</p>
<p>La valeur de <em>p</em> pour cette valeur de <em>F</em> est 0,001, qui est la même que celle obtenue pour le test de <em>t</em> ci-dessus. Ceci s’explique par le fait que la statistique de <em>F</em> est égale à <span class="math inline">\(t^2\)</span> (<span class="math inline">\(21,62 = 2,44^2\)</span>).</p>
</section><section id="contrastes-orthogonaux-et-indépendance" class="level6" data-number="3.3.2.4.2.3"><h6 data-number="3.3.2.4.2.3" class="anchored" data-anchor-id="contrastes-orthogonaux-et-indépendance">
<span class="header-section-number">3.3.2.4.2.3</span> Contrastes orthogonaux et indépendance</h6>
<p><strong>Contrastes pour groupes de moyennes</strong></p>
<p>Les contrastes nous permettent également de comparer des groupes de moyennes avec d’autres groupes de moyennes. Dans notre exemple, supposons que nous ayons l’hypothèse préalable que les traitements en général ont un effet différents de celui des contrôles sur les résultats des tests. En d’autres termes, nous voulons comparer la moyenne des deux conditions (tumostat et inhibin 4) avec le contrôle.</p>
<p>Nos poids seront alors de 1 pour le contrôle, et de -.5 pour le traitement tumostat et -.5 pour le traitement inhibin 4, et de zéro pour les conditions restantes (s’il y en avait). La combinaison linéaire de moyennes correspondante est la suivante:</p>
<p><span class="math display">\[ \psi = (1) \times 9 + (-0,5) \times 6 + (-0,5) \times 3 = 4,5\]</span>.</p>
<p>Vous devez vous convaincre que cette valeur, <span class="math inline">\(\psi\)</span>, est la différence entre le contrôle et la moyenne des deux traitements. Elle doit avoir une valeur attendue de zéro pour l’hypothèse nulle. Si la somme de tous les poids est égale à zéro, la valeur attendue du contraste sera égale à zéro sous l’hypothèse nulle.</p>
<p>L’erreur quadratique moyenne pour ce contraste est: <span class="math display">\[ SS_{contraste} = \frac{\psi^2}{(\sum \alpha_i^2)/2} = \frac{4,5^2}{\frac{(1)^2 + (-0,5)^2 + (-0,5)^2}{4}} =  54\]</span>.</p>
<p>On a donc <span class="math display">\[ F(1,9) = \frac{54}{3,33} = 16,21\]</span>. La valeur de <em>p</em> pour cette valeur est 0,002.</p>
<p><strong>Constrates orthogonaux et indépendance</strong></p>
<p>Nous avons maintenant établi deux contrastes. Nous venons de comparer les effets de l’inhibin 4 et du tumostat à la moyenne des effets du contrôle sur les résultats des tests. Auparavant, nous avons comparé le contrôle et l’inhibin 4. Vous devez comprendre que ces deux contrastes sont <strong>dépendants</strong> simplement parce qu’ils possèdent des groupes en commun.</p>
<p>Cependant, les contrastes peuvent être <strong>indépendants</strong> s’ils ne partagent aucun groupe en commun. <strong>Et même s’ils partagent des groupes, formellement, deux contrastes sont indépendants si la somme des produits de leurs poids est égale à zéro.</strong> Dans ce cas, les deux contrastes sont dits <strong>orthogonaux</strong>. Dans notre exemple: <span class="math inline">\(c_1 = [1, 0, -1] \mbox{et} c_2 = [1, -0.5, -0.5]\)</span>. La somme des produits est donc: <span class="math inline">\((1)(1) + (0)(-0.5) + (-1)(-0.5) = 1.5 \neq 0\)</span></p>
<p>Cependant le contraste <span class="math inline">\(c_3=[0.5, -1, 0.5]\)</span> est bel et bien orthogonal au contraste <span class="math inline">\(c_1\)</span>.</p>
<p>Si deux contrastes sont orthogonaux, les deux tests sont «indépendants». Si deux tests sont indépendants, la probabilité de rejeter un test ne dépend pas de la probabilité de rejeter l’autre.</p>
<p>Tester des contrastes orthogonaux sur le même ensemble de données revient à mener des expériences complètement distinctes. Comme les contrastes orthogonaux sont indépendants, nous pouvons facilement calculer le taux d’erreur par famille : <span class="math display">\[ FW = 1 - (1 - \alpha)^n \]</span> où <span class="math inline">\(n\)</span> est le nombre de contrastes orthogonaux.</p>
</section></section></section></section><section id="analyse-de-variance-à-deux-facteurs" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="analyse-de-variance-à-deux-facteurs">
<span class="header-section-number">3.3.3</span> Analyse de variance à deux facteurs</h3>
<p>Une ANOVA à facteur unique donne la probabilité que deux échantillons ou plus proviennent de populations ayant la même moyenne. L’ANOVA à facteur unique est utilisée pour analyser des données univariées provenant d’échantillons exposés à différents niveaux ou aspects d’un seul facteur. Par exemple, elle pourrait être utilisée pour comparer la consommation d’oxygène d’une espèce de crabe intertidal (la variable) à deux températures ou plus (le facteur), la croissance de tumeurs cérébrales (la variable) exposées à une série de médicaments (le facteur), ou la résistance aux insecticides d’un papillon de nuit (la variable) provenant de plusieurs endroits différents (le facteur). Cependant, les scientifiques du vivant obtiennent souvent des données univariées en relation avec plus d’un facteur. Des exemples d’expériences à deux facteurs sont la consommation d’oxygène d’un crabe intertidal à plusieurs combinaisons de température et d’humidité, la croissance de tumeurs cérébrales exposées à une série de médicaments et à différents niveaux de radiothérapie, ou la résistance aux insecticides d’un ravageur agricole provenant de différents endroits et de différentes plantes hôtes. Il serait très utile de disposer d’une analyse donnant des rapports <em>F</em> distincts (et la probabilité que les moyennes des traitements proviennent de populations ayant la même moyenne) pour chacun des deux facteurs. C’est ce que fait l’ANOVA à deux facteurs.</p>
<section id="présentation-de-lexemple-1" class="level4" data-number="3.3.3.1"><h4 data-number="3.3.3.1" class="anchored" data-anchor-id="présentation-de-lexemple-1">
<span class="header-section-number">3.3.3.1</span> Présentation de l’exemple</h4>
<p>Les blattes représentent un risque sérieux pour la santé publique, en particulier dans les villes tropicales et subtropicales où l’assainissement est insuffisant. Ces insectes vivent souvent dans les égouts et les canalisations, mais ils se nourrissent beaucoup et infestent fréquemment les zones de stockage et de préparation des aliments. Les blattes urbaines ont un régime alimentaire varié, qui comprend souvent des excréments et d’autres déchets, de sorte qu’elles peuvent contaminer les aliments et, partant, provoquer des maladies chez l’homme.</p>
<p>Un entomologiste urbain étudiant les moyens de lutte contre les blattes s’est intéressé aux effets de la température et de l’humidité sur l’activité de la blatte <em>Periplaneta americana</em>. L’entomologiste a conçu une méthode pour mesurer l’activité des blattes en plaçant ces insectes individuellement dans des bocaux de verre cylindriques à couvercle ouvert. En les filmant par le haut et en analysant les enregistrements par ordinateur, l’entomologiste a obtenu des données sur la quantité de mouvement de chaque blatte par heure.</p>
<p>L’entomologiste a mis en place une expérience pour la croissance des blattes à trois températures et trois niveaux d’humidité. Le tableau suivant récapitule la longueur en mm de 27 blattes nourries <em>ad libitum</em> et maintenues dans neuf combinaisons différentes de température et d’humidité.</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Humidité (%)</th>
<th>Temperature (°C)</th>
<th>Taille de la blatte (mm)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>33</td>
<td>20</td>
<td>1</td>
</tr>
<tr class="even">
<td>33</td>
<td>20</td>
<td>2</td>
</tr>
<tr class="odd">
<td>33</td>
<td>20</td>
<td>3</td>
</tr>
<tr class="even">
<td>33</td>
<td>30</td>
<td>5</td>
</tr>
<tr class="odd">
<td>33</td>
<td>30</td>
<td>6</td>
</tr>
<tr class="even">
<td>33</td>
<td>30</td>
<td>7</td>
</tr>
<tr class="odd">
<td>33</td>
<td>40</td>
<td>9</td>
</tr>
<tr class="even">
<td>33</td>
<td>40</td>
<td>10</td>
</tr>
<tr class="odd">
<td>33</td>
<td>40</td>
<td>11</td>
</tr>
<tr class="even">
<td>66</td>
<td>20</td>
<td>9</td>
</tr>
<tr class="odd">
<td>66</td>
<td>20</td>
<td>10</td>
</tr>
<tr class="even">
<td>66</td>
<td>20</td>
<td>11</td>
</tr>
<tr class="odd">
<td>66</td>
<td>30</td>
<td>13</td>
</tr>
<tr class="even">
<td>66</td>
<td>30</td>
<td>14</td>
</tr>
<tr class="odd">
<td>66</td>
<td>30</td>
<td>15</td>
</tr>
<tr class="even">
<td>66</td>
<td>40</td>
<td>17</td>
</tr>
<tr class="odd">
<td>66</td>
<td>40</td>
<td>18</td>
</tr>
<tr class="even">
<td>66</td>
<td>40</td>
<td>19</td>
</tr>
<tr class="odd">
<td>99</td>
<td>20</td>
<td>17</td>
</tr>
<tr class="even">
<td>99</td>
<td>20</td>
<td>18</td>
</tr>
<tr class="odd">
<td>99</td>
<td>20</td>
<td>19</td>
</tr>
<tr class="even">
<td>99</td>
<td>30</td>
<td>21</td>
</tr>
<tr class="odd">
<td>99</td>
<td>30</td>
<td>22</td>
</tr>
<tr class="even">
<td>99</td>
<td>30</td>
<td>23</td>
</tr>
<tr class="odd">
<td>99</td>
<td>60</td>
<td>25</td>
</tr>
<tr class="even">
<td>99</td>
<td>60</td>
<td>26</td>
</tr>
<tr class="odd">
<td>99</td>
<td>60</td>
<td>27</td>
</tr>
</tbody>
</table>
<section id="notion-dinteraction" class="level5" data-number="3.3.3.1.1"><h5 data-number="3.3.3.1.1" class="anchored" data-anchor-id="notion-dinteraction">
<span class="header-section-number">3.3.3.1.1</span> Notion d’interaction</h5>
<p>Les expériences qui incluent simultanément les effets de plus d’un facteur sur une variable particulière peuvent être beaucoup plus révélatrices que l’examen de chaque facteur séparément, car vous pouvez détecter certaines combinaisons de facteurs qui ont un <strong>effet synergique</strong> encore appelé <strong>interaction</strong>. En outre, l’examen de plusieurs facteurs à la fois peut permettre de réaliser d’importantes économies de temps et de ressources par rapport à la réalisation d’une série d’expériences et d’analyses distinctes.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-mckillup2011" class="csl-entry" role="listitem">
McKillup, Steve. 2011. <span>“Statistics Explained,”</span> November. <a href="https://doi.org/10.1017/cbo9781139047500">https://doi.org/10.1017/cbo9781139047500</a>.
</div>
</div>
</section></section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ebedthan\.github\.io\/biometrie\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./intro2.html" class="pagination-link" aria-label="Rappel des notions de base">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rappel des notions de base</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter2.html" class="pagination-link" aria-label="Relation entre deux variables continues">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation entre deux variables continues</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Biométrie et expérimentation par Anicet Ebou.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Ebedthan/biometrie/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>